/*
 * Copyright 2012, Lars Gersmann <lars.gersmann@gmail.com> http://github.com/lgersman
 */
(jQuery&&jQuery.fn.upload)||(function(c){if(!(c.support.ajaxProgress=("onprogress" in c.ajaxSettings.xhr()))){return}var a=c.ajax;c.ajax=function b(g,e){if(typeof(g)==="object"){e=g;g=e.url}e=e||{};var h=c.Deferred();var f=e.xhr||c.ajaxSettings.xhr;var i;e.xhr=function(){var l=this;var j=f.call(c.ajaxSettings);if(j){var k=function(m){return function(n){l.global&&c.event.trigger("ajaxProgress",[n,m,i]);c.isFunction(l.progress)&&l.progress(i,n,m);h.notifyWith(i,[n,m])}};j.upload.addEventListener("progress",k(true),false);j.addEventListener("progress",k(false),false)}return j};i=a.call(this,g,e);for(var d in h.promise()){i[d](h[d])}i.progress=h.progress;return i};c.upload=function(d,e,g,f){if(jQuery.isFunction(e)){f=f||g;g=e;e=undefined}return c.ajax({processData:false,contentType:false,type:"POST",url:d,data:e,success:g,dataType:f})}})(jQuery);